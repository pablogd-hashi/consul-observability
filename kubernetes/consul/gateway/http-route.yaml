# kubernetes/consul/gateway/http-route.yaml
# Routes all traffic entering the API Gateway to the web service.
# The parentRef links this route to the api-gateway in the consul namespace.
# The web service handles the full call chain: web → api → [payments, cache] → currency → rates.
apiVersion: gateway.networking.k8s.io/v1beta1
kind: HTTPRoute
metadata:
  name: web-route
  namespace: default
spec:
  parentRefs:
    - name: api-gateway
      namespace: consul
      sectionName: http
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        - name: web
          port: 9090
